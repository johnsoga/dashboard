<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <title>Dashboard</title>
    <style>
    #hchart { width: 800px; height: 500px; border: 1px solid #bbb }
    </style>
</head>

<body>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
<script src="http://code.highcharts.com/highcharts.js"></script>
<script src="/socket.io/socket.io.js"></script>
<script>
    var socket = io();
    var hchart;

    function requestData() {
        socket.on('dataUpdate', function (data) {
            //document.getElementById('updated-data').innerHTML += JSON.stringify(data) + "\n";
            var series = hchart.series[0];
            shift = series.data.length > 20;
            hchart.series[0].addPoint([data.date, data.data], true, shift);
        });
    }

    $(document).ready(function() {
        hchart = new Highcharts.Chart({
            chart: {
                renderTo: 'hchart',
                type: 'areaspline',
                animation: Highcharts.svg,
                events: {
                    load: setTimeout(requestData(), 1000);
                }
            },
            xAxis: {
                type: 'datetime',
                tickPixelInterval: 150
            },
            yAxis: {
                max: 100,
                min: 0,
            },
            series: [{
                marker: {
                    enabled: false
                },
                data: []
            }]
        });
    });

</script>
<h1>Real-time Dashboard</h1>
<div id='hchart'></div>
<!-- <pre id='updated-data'></pre> -->
</body>
</html>
